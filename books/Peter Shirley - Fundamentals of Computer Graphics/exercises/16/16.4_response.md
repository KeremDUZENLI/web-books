- **Skeleton:** A **Line Segment** from point $\mathbf{a}$ to $\mathbf{b}$.

- **Distance Calculation ($d$):**

  1.  Vector $\mathbf{u} = \mathbf{b} - \mathbf{a}$.

  2.  Vector $\mathbf{v} = \mathbf{p} - \mathbf{a}$.

  3.  Projection $t = \text{clamp}(\frac{\mathbf{v} \cdot \mathbf{u}}{\mathbf{u} \cdot \mathbf{u}}, 0, 1)$.

  4.  Closest point $\mathbf{c} = \mathbf{a} + t\mathbf{u}$.

  5.  Distance $d = \|\mathbf{p} - \mathbf{c}\|$.

- **Implicit Value ($V$):** Using the "Wyvill" fall-off (Exercise 1 style):

  $$V(d) = (1 - d^2/R^2)^3 \quad \text{if } d < R \text{ else } 0$$

- **Gradient ($\nabla V$):**

  - $\nabla V = \frac{\partial V}{\partial d} \nabla d$.

  - $\nabla d = \frac{\mathbf{p} - \mathbf{c}}{d}$ (Unit vector pointing away from line).

  - Derivative: $\frac{\partial V}{\partial d} = 3(1 - d^2/R^2)^2 \cdot (-2d/R^2)$.

  - Result: $\nabla V(\mathbf{p}) = -\frac{6d}{R^2} (1 - \frac{d^2}{R^2})^2 \cdot \frac{\mathbf{p} - \mathbf{c}}{d} = -\frac{6}{R^2} (1 - \frac{d^2}{R^2})^2 (\mathbf{p} - \mathbf{c})$.

- **Problem:** Solid textures require 3D world coordinates $(x, y, z)$, but rasterization operates in 2D screen space.

- **Method:** Reconstruct the world position using the depth buffer.

  1.  **Read Depth:** Obtain the z-buffer value $z_s$ for the current pixel $(x_s, y_s)$.

  2.  **NDC Coordinate:** Convert to Normalized Device Coordinates:

      $\mathbf{p}_{ndc} = (2\frac{x_s}{width}-1, 2\frac{y_s}{height}-1, 2z_s-1, 1)$.

  3.  **Inverse Transform:** Multiply by the inverse View-Projection matrix:

      $\mathbf{p}_{world} = (\mathbf{M}_{proj} \mathbf{M}_{view})^{-1} \mathbf{p}_{ndc}$.

  4.  **Homogenize:** Divide by $w$: $\mathbf{p}_{final} = \mathbf{p}_{world} / p_{world}.w$.

  5.  **Evaluate:** Use $\mathbf{p}_{final}$ as the input to the noise or pattern function.

- **Goal:** Verify that $\frac{1}{h(t)} = \frac{1}{h_r} + t \left( \frac{1}{h_R} - \frac{1}{h_r} \right)$ is NOT generally true, but the related screen-space interpolation is valid.

- **Context:**

  - $h(t) = h_r + t(h_R - h_r)$ is the homogeneous $w$-coordinate interpolated linearly in world space $t$.

  - Screen space interpolation uses a parameter $s$ (barycentric coordinate in 2D), not $t$.

  - The relationship between $s$ and $t$ is $s = \frac{h_R t}{h(t)}$.

- **Derivation:**

  1.  Start with the linear interpolation of $1/h$ in screen space (Equation 11.6):

  $$
  \text{Val} = (1-s)\frac{1}{h_r} + s\frac{1}{h_R} = \frac{1}{h_r} + s\left(\frac{1}{h_R} - \frac{1}{h_r}\right)
  $$

  2.  Substitute $s = \frac{h_R t}{h_r + t(h_R - h_r)}$:

  $$
  \text{Val} = \frac{1}{h_r} + \frac{h_R t}{h_r + t(h_R - h_r)} \left(\frac{h_r - h_R}{h_R h_r}\right)
  $$

  3.  Simplify the second term:

  $$
  \frac{h_R t (h_r - h_R)}{h(t) h_R h_r} = \frac{t(h_r - h_R)}{h(t) h_r}
  $$

  4.  Combine with first term:

  $$
  \frac{h(t) + t(h_r - h_R)}{h(t) h_r} = \frac{(h_r + t h_R - t h_r) + t h_r - t h_R}{h(t) h_r} = \frac{h_r}{h(t) h_r} = \frac{1}{h(t)}
  $$

- **Result:** The equality holds, proving that linearly interpolating the reciprocal of the homogeneous coordinate ($1/h$) in screen space ($s$) correctly recovers the reciprocal of the true depth ($1/h(t)$).

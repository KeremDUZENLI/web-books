### Answer 16.5

**System of Equations (Pendulum):**

Let state vector .
Derivative function .

**Vector RK4 Implementation:**

```cpp
struct State { float theta; float omega; };

State F(const State& s, float t) {
    float constant = - (m * g * L) / I;
    return { s.omega, constant * sin(s.theta) };
}

State RK4_Vector(State s, float t, float h) {
    State k1 = F(s, t);
    
    State s2 = { s.theta + 0.5f * h * k1.theta, s.omega + 0.5f * h * k1.omega };
    State k2 = F(s2, t + 0.5f * h);
    
    State s3 = { s.theta + 0.5f * h * k2.theta, s.omega + 0.5f * h * k2.omega };
    State k3 = F(s3, t + 0.5f * h);
    
    State s4 = { s.theta + h * k3.theta, s.omega + h * k3.omega };
    State k4 = F(s4, t + h);

    float theta_new = s.theta + (h/6.0f)*(k1.theta + 2*k2.theta + 2*k3.theta + k4.theta);
    float omega_new = s.omega + (h/6.0f)*(k1.omega + 2*k2.omega + 2*k3.omega + k4.omega);
    
    return { theta_new, omega_new };
}
```

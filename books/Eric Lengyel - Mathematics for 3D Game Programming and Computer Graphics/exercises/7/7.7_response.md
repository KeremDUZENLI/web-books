### Answer 7.7

**Ray Tracer Algorithm Structure:**

1.  **Setup**: Define sphere objects (radius, position, material properties $D, S, m$) and lights (Directional, Point, Spot).

2.  **Ray Generation**: For each pixel $(x, y)$ in the viewport:
    * Construct ray $R(t) = O + tD$, where $O$ is camera origin and $D$ is normalized vector through the pixel.

3.  **Intersection**:
    * Intersect ray with all spheres using quadratic formula (Chapter 6).
    * Find closest valid $t > 0$. If no hit, store background color.

4.  **Lighting Calculation (at intersection point $P$ with normal $N$):**
    * Initialize color $K = \text{Ambient}$.
    * For each light $i$:
        * Calculate Light Vector $L_i$ and Distance $d_i$.
        * Calculate Attenuation $Att_i$ (1.0 for directional, Eq 7.3 for point, Eq 7.4 for spot).
        * Check Visibility (Shadow Ray): Cast ray from $P$ to Light. If blocked, skip.
        * **Diffuse**: $K_{diff} = D \cdot C_i \cdot \max(N \cdot L_i, 0)$.
        * **Specular**: Calculate Halfway vector $H_i = (L_i + V) / ||L_i + V||$.
            $K_{spec} = S \cdot C_i \cdot \max(N \cdot H_i, 0)^m$.
        * **Accumulate**: $K += Att_i \cdot (K_{diff} + K_{spec})$.

5.  **Output**: Write final color $K$ to the pixel.
